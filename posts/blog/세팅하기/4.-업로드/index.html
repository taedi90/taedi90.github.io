<!doctype html><html>
<head>
<title>Github 블로그 설정 4. 대망의 업로드</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<link rel=stylesheet href=/css/bootstrap.min.css>
<link rel=stylesheet href=/css/layouts/main.css>
<link rel=stylesheet href=/css/navigators/navbar.css>
<link rel=stylesheet href=/css/plyr.css>
<link rel=stylesheet href=/css/flag-icon.min.css>
<link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css>
<script defer src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1882367656929494" crossorigin=anonymous></script>
<link rel=icon type=image/png href=/images/site/favicon.svg>
<meta property="og:title" content="Github 블로그 설정 4. 대망의 업로드">
<meta property="og:description" content="서론 어느정도 설정을 마쳤다면 마지막은 세팅한 블로그를 Github Pages 에 올리는 일만 남았다. Hugo는 자동빌드가 되지않아 push 만 하면 페이지가 업데이트되는 jekyll과는 조금 다르다고 한다.
그래서 전체 프로젝트 파일과 빌드 된 파일을 각각 저장할 공간이 필요한데 리포지토리를 각각 분리하여 구분하는 방식과 한개 리포지토리에 브랜치를 나누어 관리하는 방식이 있었다. 두가지 방법 모두 시도해보았는데 개인적으로 리포지토리가 많으면 관리가 어렵다고 느껴 한개 리포지토리를 활용한 방법을 택했다.
진행순서 1. 리포지토리 생성 &lsquo;자신의 아이디.github.io&rsquo; 라는 이름의 리포지토리를 생성한다.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://log.taedi.net/posts/blog/%EC%84%B8%ED%8C%85%ED%95%98%EA%B8%B0/4.-%EC%97%85%EB%A1%9C%EB%93%9C/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-09-13T00:00:00+09:00">
<meta property="article:modified_time" content="2021-10-17T09:48:00+09:00">
<meta name=description content="Github 블로그 설정 4. 대망의 업로드">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css>
<link rel=stylesheet href=/css/layouts/single.css>
<link rel=stylesheet href=/css/navigators/sidebar.css>
<link rel=stylesheet href=/css/style.css>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-52CHZ4CKK9"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-52CHZ4CKK9',{anonymize_ip:!1})}</script>
</head>
<body data-spy=scroll data-target=#TableOfContents data-offset=80>
<div class="container-fluid bg-dimmed wrapper">
<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
<div class=container>
<button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/>
<img src=/images/site/main-logo.svg alt=Logo>
Taedi's Log</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse lang-selector" id=top-nav-items>
<ul class="navbar-nav ml-auto">
</ul>
</div>
</div>
<img src=/images/site/main-logo.svg class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo.svg class=d-none id=inverted-logo alt="Inverted Logo">
</nav>
<section class=sidebar-section id=sidebar-section>
<div class=sidebar-holder>
<div class=sidebar id=sidebar>
<form class=mx-auto method=get action=/search>
<input type=text name=keyword placeholder=Search data-search id=search-box>
</form>
<div class=sidebar-tree>
<ul class=tree id=tree>
<li id=list-heading><a href=/posts data-filter=all>Posts</a></li>
<div class=subtree>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/java/>JAVA</a>
<ul>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/java/ide/>ide</a>
<ul>
<li><a href=/posts/java/ide/%EC%9D%B4%ED%81%B4%EB%A6%BD%EC%8A%A4-%EB%A7%A5-%ED%95%9C%EA%B8%80-%EC%A7%A4%EB%A6%BC%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0/ title="이클립스 맥 한글 짤림문제 해결">이클립스 맥 한글 짤림문제 해결</a></li>
</ul>
</li>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/java/tomcat/>tomcat</a>
<ul>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/java/tomcat/%EC%9E%90%EB%8F%99-%EB%B0%B0%ED%8F%AC/>자동 배포</a>
<ul>
<li><a href=/posts/java/tomcat/%EC%9E%90%EB%8F%99-%EB%B0%B0%ED%8F%AC/maven/ title=maven>maven</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/python/>python</a>
<ul>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/python/setting/>setting</a>
<ul>
<li><a href=/posts/python/setting/%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95/ title="가상환경 설정">가상환경 설정</a></li>
</ul>
</li>
</ul>
</li>
<li>
<i class="fas fa-minus-circle"></i><a class=active href=/posts/blog/>blog</a>
<ul class=active>
<li>
<i class="fas fa-minus-circle"></i><a class=active href=/posts/blog/%EC%84%B8%ED%8C%85%ED%95%98%EA%B8%B0/>세팅하기</a>
<ul class=active>
<li><a href=/posts/blog/%EC%84%B8%ED%8C%85%ED%95%98%EA%B8%B0/1.-hugo-%EC%84%A4%EC%B9%98/ title="1. Hugo 설치">1. Hugo 설치</a></li>
<li><a href=/posts/blog/%EC%84%B8%ED%8C%85%ED%95%98%EA%B8%B0/2.-%ED%85%8C%EB%A7%88-%EC%84%B8%ED%8C%85/ title="2. 테마 세팅">2. 테마 세팅</a></li>
<li><a href=/posts/blog/%EC%84%B8%ED%8C%85%ED%95%98%EA%B8%B0/3.-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%B3%80%ED%99%98/ title="3. 페이지 변환">3. 페이지 변환</a></li>
<li><a class=active href=/posts/blog/%EC%84%B8%ED%8C%85%ED%95%98%EA%B8%B0/4.-%EC%97%85%EB%A1%9C%EB%93%9C/ title="4. 업로드">4. 업로드</a></li>
</ul>
</li>
</ul>
</li>
</div>
</ul>
</div>
</div>
</div>
</section>
<section class=content-section id=content-section>
<div class=content>
<div class="container p-0 read-area">
<div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://log.taedi.net/images/hero/blog.png)>
</div>
<div class=page-content>
<div class="author-profile ml-auto align-self-lg-center">
<img class=rounded-circle src=/images/author/avatar_hue4fa7b2d8e73b32dce85afe643c3f5c5_90375_120x120_fit_box_3.png alt="Author Image">
<h5 class=author-name>Taesoo Kim</h5>
<p>2021년 09월 13일</p>
</div>
<div class=title>
<h1>Github 블로그 설정 4. 대망의 업로드</h1>
</div>
<div class=taxonomy-terms>
<ul style=padding-inline-start:0>
<li class=rounded><a href=/tags/blog class="btn, btn-sm">blog</a></li>
<li class=rounded><a href=/tags/github-pages class="btn, btn-sm">github pages</a></li>
<li class=rounded><a href=/tags/hugo class="btn, btn-sm">hugo</a></li>
</ul>
</div>
<div class=post-content id=post-content>
<h2 id=서론>서론</h2>
<p>어느정도 설정을 마쳤다면 마지막은 세팅한 블로그를 Github Pages 에 올리는 일만 남았다. Hugo는 자동빌드가 되지않아 push 만 하면 페이지가 업데이트되는 jekyll과는 조금 다르다고 한다.</p>
<p>그래서 전체 프로젝트 파일과 빌드 된 파일을 각각 저장할 공간이 필요한데 리포지토리를 각각 분리하여 구분하는 방식과 한개 리포지토리에 브랜치를 나누어 관리하는 방식이 있었다. 두가지 방법 모두 시도해보았는데 개인적으로 리포지토리가 많으면 관리가 어렵다고 느껴 한개 리포지토리를 활용한 방법을 택했다.</p>
<h2 id=진행순서>진행순서</h2>
<h3 id=1-리포지토리-생성>1. 리포지토리 생성</h3>
<p>&lsquo;자신의 아이디.github.io&rsquo; 라는 이름의 리포지토리를 생성한다.</p>
<h3 id=2-source-브랜치-생성>2. source 브랜치 생성</h3>
<p>브랜치 이름은 상관없겠지만 참고한 사이트를 따라 source라는 이름으로 브랜치를 생성하여 주었다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># create the source branch</span>
$ git checkout -b source
<span style=color:#75715e># push the source branch into Github</span>
$ git push origin source
</code></pre></div><h3 id=3-github-설정>3. Github 설정</h3>
<p>settings > branches > default branch 를 &lsquo;source&rsquo; 브랜치로 설정</p>
<p><img src=images/pic-0009.png alt="스크린샷 2021-09-15 오후 10.28.40.png"></p>
<p>settings > pages > source 를 &lsquo;main&rsquo; 브랜치로 설정</p>
<p><img src=images/pic-0006.png alt="스크린샷 2021-09-15 오후 10.30.40.png"></p>
<p>settings > actions > actions permissions > allow all actions</p>
<p><img src=images/pic-0004.png alt="스크린샷 2021-09-15 오후 10.32.17.png"></p>
<p>(선택사항) 2차 도메인 설정</p>
<p><img src=images/pic-0008.png alt="스크린샷 2021-09-15 오후 10.37.29.png"></p>
<h3 id=4-프로젝트-폴더내-githubworkflowdeploy-siteyaml-파일-생성>4. 프로젝트 폴더내 .github/workflow/deploy-site.yaml 파일 생성</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy to Github Pages</span>

<span style=color:#f92672>on</span>:
  <span style=color:#f92672>push</span>:
    <span style=color:#f92672>branches</span>:
      - <span style=color:#ae81ff>source </span> <span style=color:#75715e># Set a branch to deploy</span>
  <span style=color:#f92672>pull_request</span>:

<span style=color:#f92672>jobs</span>:
  <span style=color:#f92672>deploy</span>:
    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-20.04</span>
    <span style=color:#f92672>steps</span>:
      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>submodules</span>: <span style=color:#66d9ef>true</span>  <span style=color:#75715e># Fetch Hugo themes (true OR recursive)</span>
          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>    <span style=color:#75715e># Fetch all history for .GitInfo and .Lastmod</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Setup Hugo</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#39;latest&#39;</span>
          <span style=color:#f92672>extended</span>: <span style=color:#66d9ef>true</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>hugo --minify</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-gh-pages@v3</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>github_token</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
          <span style=color:#f92672>publish_branch</span>: <span style=color:#ae81ff>main</span> <span style=color:#75715e># if your main branch is `master` use that here.</span>
          <span style=color:#f92672>publish_dir</span>: <span style=color:#ae81ff>./public</span>
</code></pre></div><p>만약 2차 도메인을 사용한다면 아래 코드를 사용</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy to Github Pages</span>

<span style=color:#f92672>on</span>:
  <span style=color:#f92672>push</span>:
    <span style=color:#f92672>branches</span>:
      - <span style=color:#ae81ff>source </span> <span style=color:#75715e># Set a branch to deploy</span>
  <span style=color:#f92672>pull_request</span>:

<span style=color:#f92672>jobs</span>:
  <span style=color:#f92672>deploy</span>:
    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-20.04</span>
    <span style=color:#f92672>steps</span>:
      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>submodules</span>: <span style=color:#66d9ef>true</span>  <span style=color:#75715e># Fetch Hugo themes (true OR recursive)</span>
          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>    <span style=color:#75715e># Fetch all history for .GitInfo and .Lastmod</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Setup Hugo</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#39;latest&#39;</span>
          <span style=color:#f92672>extended</span>: <span style=color:#66d9ef>true</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>hugo --minify</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>CNAME copy</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>cp CNAME ./public</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-gh-pages@v3</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>github_token</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
          <span style=color:#f92672>publish_branch</span>: <span style=color:#ae81ff>main</span> <span style=color:#75715e># if your main branch is `master` use that here.</span>
          <span style=color:#f92672>publish_dir</span>: <span style=color:#ae81ff>./public</span>
</code></pre></div><h3 id=5-배포>5. 배포</h3>
<p>이제 source 브랜치에서 푸시하면 자동으로 배포된다.</p>
<h3 id=기타-오류-해결-삽질기>기타. 오류 해결 (삽질기)</h3>
<h4 id=푸시-이후-설정한-action이-제대로-실행되지-않는-문제>푸시 이후 설정한 action이 제대로 실행되지 않는 문제</h4>
<p><img src=images/pic-0002.png alt="스크린샷 2021-09-15 오후 10.42.51.png"></p>
<p>빌드에서 오류가 난다&mldr;</p>
<p><img src=images/pic-0007.png alt="스크린샷 2021-09-15 오후 10.43.46.png"></p>
<p>구글링 중에 찾은 내용으로 정확히 이해는 못했지만 서브모듈을 다시 인덱싱 해주라는 내용인듯</p>
<p><img src=images/pic-0010.png alt="스크린샷 2021-09-15 오후 11.16.40.png"></p>
<p><img src=images/pic-0001.png alt="스크린샷 2021-09-15 오후 11.16.59.png"></p>
<p>하지만 오류가 멈추질 않는다..</p>
<p><img src=images/pic-0003.png alt="스크린샷 2021-09-15 오후 11.23.33.png"></p>
<p>deploy-site.yaml 에서 if: github.ref == &lsquo;refs/heads/main&rsquo; 를 지워본다. (위의 코드에서는 이미 지워져있음)</p>
<p>해결!</p>
<h4 id=deploy-시에-custom-domain-이-초기화-되어버리는-현상>deploy 시에 custom domain 이 초기화 되어버리는 현상</h4>
<p><img src=images/pic-0005.png alt="스크린샷 2021-09-16 오후 5.21.50.png"></p>
<p>custiom domain 을 다시 설정한 뒤 main 리포지토리에 생성 된 CNAME 파일을 받아 프로젝트 루트 디렉토리에 복사, 그리고 아래 코드를 deploy-site.yaml 에 추가</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>CNAME copy</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>cp CNAME ./public</span>
</code></pre></div><p>해결!</p>
<h3 id=참고>참고</h3>
<ul>
<li><a href=https://toha-guides.netlify.app/posts/getting-started/github-pages/>https://toha-guides.netlify.app/posts/getting-started/github-pages/</a></li>
<li><a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/>https://gohugo.io/hosting-and-deployment/hosting-on-github/</a></li>
</ul>
</div>
<ins class=adsbygoogle style=display:block data-ad-client=ca-pub-1882367656929494 data-ad-slot=9457951065 data-ad-format=auto data-full-width-responsive=true></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
<hr>
<div class="row next-prev-navigator">
<div class="col-md-6 previous-article">
<a href=/posts/blog/%EC%84%B8%ED%8C%85%ED%95%98%EA%B8%B0/3.-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%B3%80%ED%99%98/ title="Github 블로그 설정 3. Notion 페이지 변환" class="btn btn-outline-info">
<div><i class="fas fa-chevron-circle-left"></i> 이전</div>
<div class=next-prev-text>Github 블로그 설정 3. Notion 페이지 변환</div>
</a>
</div>
</div>
<hr>
<div class=utterances></div>
<script src=https://utteranc.es/client.js repo=taedi90/blog_comments issue-term=pathname theme=github-light crossorigin=anonymous defer></script>
</div>
</div>
</div>
<a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a>
</section>
<section class=toc-section id=toc-section>
<div class=toc-holder>
<h5 class="text-center pl-3">List</h5>
<hr>
<div class=toc>
<nav id=TableOfContents>
<ul>
<li><a href=#서론>서론</a></li>
<li><a href=#진행순서>진행순서</a>
<ul>
<li><a href=#1-리포지토리-생성>1. 리포지토리 생성</a></li>
<li><a href=#2-source-브랜치-생성>2. source 브랜치 생성</a></li>
<li><a href=#3-github-설정>3. Github 설정</a></li>
<li><a href=#4-프로젝트-폴더내-githubworkflowdeploy-siteyaml-파일-생성>4. 프로젝트 폴더내 .github/workflow/deploy-site.yaml 파일 생성</a></li>
<li><a href=#5-배포>5. 배포</a></li>
<li><a href=#기타-오류-해결-삽질기>기타. 오류 해결 (삽질기)</a>
<ul>
<li><a href=#푸시-이후-설정한-action이-제대로-실행되지-않는-문제>푸시 이후 설정한 action이 제대로 실행되지 않는 문제</a></li>
<li><a href=#deploy-시에-custom-domain-이-초기화-되어버리는-현상>deploy 시에 custom domain 이 초기화 되어버리는 현상</a></li>
</ul>
</li>
<li><a href=#참고>참고</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</section>
</div>
<footer class="container-fluid text-center align-content-center footer pb-2">
<div class="container pt-5">
<div class="row text-left">
<div class="col-md-4 col-sm-12">
<h5>Contact</h5>
<ul>
<li><span>Email: </span> <span>taedi90@gmail.com</span></li>
<li><span>Github: </span> <span>https://github.com/taedi90</span></li>
</ul>
</div>
</div>
</div>
</footer>
<script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script>
<script>$(document).ready(function(){$('p').has('img').css('text-align','center')})</script>
</body>
</html>